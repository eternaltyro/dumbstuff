ARCH INSTALL (BTRFS + crpyto_LUKS)

Boot with media
loadkeys Dvorak
List disks (fdisk -l)
Use parted to create ESP and Root data partitions

+—+—— /dev/sda
      |
      +—— /dev/sda1, 512MiB, fat32, ESP
      +—— /dev/sdb2, 100%, btrfs, linux

/dev/sda1 mounted on /boot

	# parted /dev/sda
	(parted) mklabel gpt
	(parted) mkpart ESP fat32 1MiB 513MiB
	(parted) set 1 boot on
	(parted) mkpart primary btrfs 513MiB 100%
	(parted) quit

	# mkfs.fat -F32 /dev/sda1

	# cryptsetup —verbose —cipher aes-xts-plain64 —hash sha512 —key-size 512 —iter-time 5000 —use-random luksFormat /dev/sda2

## SWAP CREATION LATER ON  - encrypt with plain encryption with throwaway keys from urandom.

	# cryptsetup luksOpen /dev/sda2 cryptted
	# mkfs.btrfs /dev/mapper/cryptted
	# mount /dev/mapper/cryptted /mnt
	# btrfs subvolume create /mnt/root
	# btrfs subvolume create /mnt/root/home
	# btrfs sub volume create /mnt/root/var
	# btrfs sub volume create /mnt/root/opt
	# btrfs sub volume create /mnt/root/usr
	# mkdir /mnt/boot
	# umount /mnt
	# mount -o defaults,compress=lzo,subvol=root /dev/mapper/cryptted /mnt
	# mount /dev/sda1 /mnt/boot

	# pacstrap /mnt base base-devel
	# genfstab -U /mnt > /mnt/etc/fstab
	# arch-chroot /mnt /bin/bash
	# nano /etc/locale.gen # Edit to enable en_US.UTF-8
	# locale-gen
	# echo LANG=en_US.UTF-8 > /etc/locale.conf
	# echo KEYMAP=dvorak > /etc/vconsole.conf
	# echo FONT=lat9w-16 >> /etc/vconsole.conf
	# tzselect
	# ln -sf /usr/share/zoneinfo/Asia/Kolkata /etc/localtime
	# hwclock —systohc —utc
	
# nano /etc/mkinitcpio.conf
	##edit the HOOKS line. Remove fsck and add btrfs; add encrypt for LUKS;
	HOOKS="base udev autodetect modconf encrypt block filesystems keyboard btrfs”
# pacman -S btrfs-progs
# mkinitcpio -p linux
# bootctl install
# cat /boot/loader/entries/arch.conf
title         Arch Linux
linux        /vmlinuz-linux
initrd        /initramfs-linux.img
options    cryptdevice=UUID=14420948-2cea-4de7-b042-40f67c618660:cryptted root=/dev/mapper/roasted rw rootflags=compress=lzo,subvol=root

# cat /boot/loader/loader.conf
timeout 3
default arch

# echo cockroach > /etc/hostname
# cat /etc/hosts
127.0.0.1 localhost cockroach

# pacman -S iw wpa_supplicant dialog
#  passwd

# reboot


##### POST INSTALL CONFIGURATION

## Configure Internet using netctl. 
## Interface name from `ip link`
sudo cp /etc/netctl/examples/ethernet-static /etc/netctl/
sudo netctl start ethernet-static
sudo netctl enable ethernet-static

sudo useradd -m -G wheel -s /bin/zsh eternaltyro
sudo passwd eternaltyro
Enter new UNIX password: somelongcompl3x$hi+
Retype new UINX password: samelongcompl3x$hi+
passwd: password updated successfully

sudo pacman -S xorg-server xorg-xinit xf86-input-synaptics
sudo pacman -S rxvt-unicode rxvt-unicode-terminfo
sudo pacman -S awesome zsh slim slim-themes vicious
sudo pacman -S alsa-utils moc vlc mpd
sudo pacman -S btrfs-progs snapper
sudo pacman -S firefox chromium
sudo pacman -S libreoffice-fresh
#rlwrap, dex, wireless_tools 

visudo
Cmnd_Alias    USER1 = /bin/kill, /usr/bin/pkill, /usr/bin/top, \
                      /sbin/halt, /sbin/reboot, /sbin/poweroff, \
                      /usr/bin/pacman, /usr/bin/vim, /usr/bin/vi, \
                      /usr/bin/systemct, /usr/bin/wifi-menu, /usr/bin/cryptsetup, \
                      /usr/bin/mount, /usr/bin/umount
myusername ALL=USER1

sudo cp /etc/X11/xinit/xinitrc ~/.xinitrc	
sudo vim /home/eternaltyro/.xinitrc

# Comment out the xterms and twm lines in the bottom and add awesome like so
setxkbmap dvorak
exec awesome

sudo vi /etc/slim.conf
sudo systemctl enable slim

## https://bbs.archlinux.org/viewtopic.php?id=120243

ZSH config
==========

Z Shell is configured the first time user logs in
# Install `prezto-git` for Zsh customization

# If virtualbox guest, add virtualbox modules
# Errors starting X could be related to this

if grep hypervisor /proc/cpuinfo > /dev/null; then
    sudo pacman -S virtualbox-guest-utils
    sudo modprobe -a vboxguest vboxvideo vboxsf
fi

Only vboxvideo and vboxguest are important. vboxsf is for shared directories.

Fix SLiM Keyboard layout issue
==============================

# pacman -S xf86-input-evdev
# cat /etc/X11/xorg.conf.d/10-evdev.conf
Section "InputClass"
        Identifier "evdev keyboard catchall"
        MatchIsKeyboard "on"
        MatchDevicePath "/dev/input/event*"
        Driver "evdev"
        
        # Keyboard layouts
        Option "XkbLayout" “latam”
EndSection
https://bbs.archlinux.org/viewtopic.php?id=96634

xorg-xbacklight
# echo 5000 > /sys/class/backlight/intel_backlight/brightness
# cat /sys/class/backlight/intel_backlight/max_brightness
pacman -S xbindkeys
xbindkeys —defaults > /home/eternaltyro/.xbindkeysrc

# Install KeePassX
================
Download the AUR package for keepassx2 and `makepkg -sri` 

# Install Lain

# Download and install lain-git package from AUR

Updating Repos: pacman -Syy
Upgrading Packages: pacman -Su | pacman -Syu
Removing Packages: pacman -R

sudo pacman -S wget
sudo pacman -S gnucash

# Install Fonts

sudo pacman -S ttf-dejavu ttf-anonymous-pro ttf-inconsolata
# Install ttf-tamil package from AUR
## Add infinality repository
pacman-key -r 962DDE58
pacman-key --lsign 962DDE58
cat <<'INFIN' >>/etc/pacman.conf
[infinality-bundle]
Server =  http://bohoomil.com/repo/$arch
INFIN

pacman -Syyy
pacman -S infinality-bundle #(select default [all] for freetype, cairo 
and fontconfig replacements)

sudo pacman -S inkscape gimp
sudo pacman -S tmux vim-airline
sudo pacman -S ntfs-3g (or you can't write to NTFS devices)
sudo pacman -S jre8-openjdk icedtea-web
sudo pacman -S virtualbox
sudo modprobe vboxdrv
sudo pacman -S vagrant docker
sudo systemctl enable docker
sudo systemctl start docker
gem install rhc ## Openshift RedHat Client
rhc-setup
PATH=$PATH:/home/yogesh/.gem/ruby/2.2.0/bin
## Install heroku toolbelt
wget -O- https://toolbelt.heroku.com/install.sh | sh
PATH=$PATH:/usr/local/heroku/bin
sudo pacman -S xorg-xrdb (rendering Xresources)
sudo pacman -S cherrytree
sudo pacman -S ibus ibus-m17n

sudo pacman -S python-pip
sudo pip install requests
sudo pip install ipython

##########################################
# YUBIKEY
# Add UDEV rules for U2F token by YubiKey
##########################################

cat <<U2F >> /etc/udev/rules.d/45-u2f.rules
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="1050", ATTRS{idProduct}=="0120", TAG+="uaccess"
U2F

########################################
# DOCKER 
# Add IP forwarding to fix container public routing issue
####################################
# cat >/etc/systemd/network/ipforward.network <<EOF
[Network]
IPForward=yes
EOF

## Blacklist PC speaker to prevent system beeps
echo "blacklist pcspkr" > /etc/modprobe.d/nobeep.conf
sudo rmmod pcspkr
